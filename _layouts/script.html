---
layout: default
---
<main class="script-wrap">
  <article class="script-body" id="script-body">
    {{ content }}
  </article>
</main>

<script>
(function () {
  const root = document.getElementById('script-body');
  if (!root) return;

  const raw = root.innerHTML
    .replace(/<\/p>\s*<p>/gi, '\n\n')
    .replace(/<br\s*\/?>/gi, '\n')
    .replace(/^\s*<p>/i, '')
    .replace(/<\/p>\s*$/i, '')
    .trim();

  const lines = raw.split('\n');
  const out = [];
  const strip = (h) => h.replace(/<[^>]*>/g, '').trim();

  for (let i = 0; i < lines.length; i++) {
    const rawLine = lines[i].replace(/\r$/, '');
    const t = strip(rawLine);

    if (!t) { out.push('<div class="gap"></div>'); continue; }
    if (/^(INT\.|EXT\.)\b/i.test(t)) { out.push(`<div class="scene">${t.toUpperCase()}</div>`); continue; }
    if (/^(FADE IN|FADE OUT|FADE TO|CUT TO)(:)?$/i.test(t)) { out.push(`<div class="transition">${t.toUpperCase().replace(/\.$/,'')}</div>`); continue; }
    if (/^\[.*\]$/.test(t)) { out.push(`<div class="action">${rawLine}</div>`); continue; }

    const isCue = /^[A-Z0-9 .'()\-]+$/.test(t) && t === t.toUpperCase() && t.length <= 40;
    if (isCue) { out.push(`<div class="cue">${t}</div>`); continue; }

    out.push(`<div class="dialogue">${rawLine}</div>`);
  }

  root.innerHTML = out.join('\n');
})();
</script>
